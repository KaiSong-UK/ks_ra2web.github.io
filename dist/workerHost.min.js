var CDWorkerHostLib;(()=>{var e={227:(e,t,r)=>{function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=r(658)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(s=o))})),e.splice(s,0,n)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())},658:(e,t,r)=>{var n;function o(e){function r(){if(r.enabled){var e=r,o=+new Date,s=o-(n||o);e.diff=s,e.prev=n,e.curr=o,n=o;for(var i=new Array(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var c=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(r,n){if("%%"===r)return r;c++;var o=t.formatters[n];if("function"==typeof o){var s=i[c];r=o.call(e,s),i.splice(c,1),c--}return r})),t.formatArgs.call(e,i);var u=r.log||t.log||console.log.bind(console);u.apply(e,i)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),"function"==typeof t.init&&t.init(r),r}(t=e.exports=o.debug=o.default=o).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length,o=0;o<n;o++)r[o]&&("-"===(e=r[o].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(824),t.names=[],t.skips=[],t.formatters={}},898:e=>{"use strict";e.exports=e=>!!e&&("symbol"==typeof Symbol.observable&&"function"==typeof e[Symbol.observable]?e===e[Symbol.observable]():"function"==typeof e["@@observable"]&&e===e["@@observable"]())},824:e=>{var t=1e3,r=60*t,n=60*r,o=24*n;function s(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,i){i=i||{};var a,c=typeof e;if("string"===c&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var s=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(s){var i=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"days":case"day":case"d":return i*o;case"hours":case"hour":case"hrs":case"hr":case"h":return i*n;case"minutes":case"minute":case"mins":case"min":case"m":return i*r;case"seconds":case"second":case"secs":case"sec":case"s":return i*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(e);if("number"===c&&!1===isNaN(e))return i.long?s(a=e,o,"day")||s(a,n,"hour")||s(a,r,"minute")||s(a,t,"second")||a+" ms":function(e){return e>=o?Math.round(e/o)+"d":e>=n?Math.round(e/n)+"h":e>=r?Math.round(e/r)+"m":e>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},49:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Observable:()=>k,Subject:()=>j,filter:()=>T,flatMap:()=>x,interval:()=>P,map:()=>E,merge:()=>M,multicast:()=>S,scan:()=>O,unsubscribe:()=>_});class n{constructor(e){this._baseObserver=e,this._pendingPromises=new Set}complete(){Promise.all(this._pendingPromises).then((()=>this._baseObserver.complete())).catch((e=>this._baseObserver.error(e)))}error(e){this._baseObserver.error(e)}schedule(e){const t=Promise.all(this._pendingPromises),r=[],n=e=>r.push(e),o=Promise.resolve().then((()=>{return s=this,i=void 0,c=function*(){yield t,yield e(n),this._pendingPromises.delete(o);for(const e of r)this._baseObserver.next(e)},new((a=void 0)||(a=Promise))((function(e,t){function r(e){try{o(c.next(e))}catch(e){t(e)}}function n(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof a?o:new a((function(e){e(o)}))).then(r,n)}o((c=c.apply(s,i||[])).next())}));var s,i,a,c})).catch((e=>{this._pendingPromises.delete(o),this._baseObserver.error(e)}));this._pendingPromises.add(o)}}const o=()=>"function"==typeof Symbol,s=e=>o()&&Boolean(Symbol[e]),i=e=>s(e)?Symbol[e]:"@@"+e;s("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"));const a=i("iterator"),c=i("observable"),u=i("species");function l(e,t){const r=e[t];if(null!=r){if("function"!=typeof r)throw new TypeError(r+" is not a function");return r}}function f(e){let t=e.constructor;return void 0!==t&&(t=t[u],null===t&&(t=void 0)),void 0!==t?t:w}function d(e){d.log?d.log(e):setTimeout((()=>{throw e}),0)}function p(e){Promise.resolve().then((()=>{try{e()}catch(e){d(e)}}))}function h(e){const t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{const e=l(t,"unsubscribe");e&&e.call(t)}}catch(e){d(e)}}function y(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function b(e,t,r){e._state="running";const n=e._observer;try{const o=n?l(n,t):void 0;switch(t){case"next":o&&o.call(n,r);break;case"error":if(y(e),!o)throw r;o.call(n,r);break;case"complete":y(e),o&&o.call(n)}}catch(e){d(e)}"closed"===e._state?h(e):"running"===e._state&&(e._state="ready")}function m(e,t,r){if("closed"!==e._state)return"buffering"===e._state?(e._queue=e._queue||[],void e._queue.push({type:t,value:r})):"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:r}],void p((()=>function(e){const t=e._queue;if(t){e._queue=void 0,e._state="ready";for(const r of t)if(b(e,r.type,r.value),"closed"===e._state)break}}(e)))):void b(e,t,r)}class v{constructor(e,t){this._cleanup=void 0,this._observer=e,this._queue=void 0,this._state="initializing";const r=new g(this);try{this._cleanup=t.call(void 0,r)}catch(e){r.error(e)}"initializing"===this._state&&(this._state="ready")}get closed(){return"closed"===this._state}unsubscribe(){"closed"!==this._state&&(y(this),h(this))}}class g{constructor(e){this._subscription=e}get closed(){return"closed"===this._subscription._state}next(e){m(this._subscription,"next",e)}error(e){m(this._subscription,"error",e)}complete(){m(this._subscription,"complete")}}class w{constructor(e){if(!(this instanceof w))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof e)throw new TypeError("Observable initializer must be a function");this._subscriber=e}subscribe(e,t,r){return"object"==typeof e&&null!==e||(e={next:e,error:t,complete:r}),new v(e,this._subscriber)}pipe(e,...t){let r=this;for(const n of[e,...t])r=n(r);return r}tap(e,t,r){const n="object"!=typeof e||null===e?{next:e,error:t,complete:r}:e;return new w((e=>this.subscribe({next(t){n.next&&n.next(t),e.next(t)},error(t){n.error&&n.error(t),e.error(t)},complete(){n.complete&&n.complete(),e.complete()},start(e){n.start&&n.start(e)}})))}forEach(e){return new Promise(((t,r)=>{if("function"!=typeof e)return void r(new TypeError(e+" is not a function"));function n(){o.unsubscribe(),t(void 0)}const o=this.subscribe({next(t){try{e(t,n)}catch(e){r(e),o.unsubscribe()}},error(e){r(e)},complete(){t(void 0)}})}))}map(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(f(this))((t=>this.subscribe({next(r){let n=r;try{n=e(r)}catch(e){return t.error(e)}t.next(n)},error(e){t.error(e)},complete(){t.complete()}})))}filter(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(f(this))((t=>this.subscribe({next(r){try{if(!e(r))return}catch(e){return t.error(e)}t.next(r)},error(e){t.error(e)},complete(){t.complete()}})))}reduce(e,t){if("function"!=typeof e)throw new TypeError(e+" is not a function");const r=f(this),n=arguments.length>1;let o=!1,s=t;return new r((t=>this.subscribe({next(r){const i=!o;if(o=!0,!i||n)try{s=e(s,r)}catch(e){return t.error(e)}else s=r},error(e){t.error(e)},complete(){if(!o&&!n)return t.error(new TypeError("Cannot reduce an empty sequence"));t.next(s),t.complete()}})))}concat(...e){const t=f(this);return new t((r=>{let n,o=0;return function s(i){n=i.subscribe({next(e){r.next(e)},error(e){r.error(e)},complete(){o===e.length?(n=void 0,r.complete()):s(t.from(e[o++]))}})}(this),()=>{n&&(n.unsubscribe(),n=void 0)}}))}flatMap(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");const t=f(this);return new t((r=>{const n=[],o=this.subscribe({next(o){let i;if(e)try{i=e(o)}catch(e){return r.error(e)}else i=o;const a=t.from(i).subscribe({next(e){r.next(e)},error(e){r.error(e)},complete(){const e=n.indexOf(a);e>=0&&n.splice(e,1),s()}});n.push(a)},error(e){r.error(e)},complete(){s()}});function s(){o.closed&&0===n.length&&r.complete()}return()=>{n.forEach((e=>e.unsubscribe())),o.unsubscribe()}}))}[(Symbol.observable,c)](){return this}static from(e){const t="function"==typeof this?this:w;if(null==e)throw new TypeError(e+" is not an object");const r=l(e,c);if(r){const n=r.call(e);if(Object(n)!==n)throw new TypeError(n+" is not an object");return function(e){return e instanceof w}(n)&&n.constructor===t?n:new t((e=>n.subscribe(e)))}if(s("iterator")){const r=l(e,a);if(r)return new t((t=>{p((()=>{if(!t.closed){for(const n of r.call(e))if(t.next(n),t.closed)return;t.complete()}}))}))}if(Array.isArray(e))return new t((t=>{p((()=>{if(!t.closed){for(const r of e)if(t.next(r),t.closed)return;t.complete()}}))}));throw new TypeError(e+" is not observable")}static of(...e){return new("function"==typeof this?this:w)((t=>{p((()=>{if(!t.closed){for(const r of e)if(t.next(r),t.closed)return;t.complete()}}))}))}static get[u](){return this}}o()&&Object.defineProperty(w,Symbol("extensions"),{value:{symbol:c,hostReportError:d},configurable:!0});const k=w,_=function(e){"function"==typeof e?e():e&&"function"==typeof e.unsubscribe&&e.unsubscribe()};const T=function(e){return t=>new k((r=>{const o=new n(r),s=t.subscribe({complete(){o.complete()},error(e){o.error(e)},next(t){o.schedule((r=>{return n=this,o=void 0,i=function*(){(yield e(t))&&r(t)},new((s=void 0)||(s=Promise))((function(e,t){function r(e){try{c(i.next(e))}catch(e){t(e)}}function a(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof s?n:new s((function(e){e(n)}))).then(r,a)}c((i=i.apply(n,o||[])).next())}));var n,o,s,i}))}});return()=>_(s)}))};const x=function(e){return t=>new k((r=>{const o=new n(r),i=t.subscribe({complete(){o.complete()},error(e){o.error(e)},next(t){o.schedule((r=>{return n=this,o=void 0,a=function*(){var n,o;const i=yield e(t);if((u=i)&&s("iterator")&&u[Symbol.iterator]||function(e){return e&&s("asyncIterator")&&e[Symbol.asyncIterator]}(i))try{for(var a,c=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,o,(t=e[r](t)).done,t.value)}))}}}(i);!(a=yield c.next()).done;){const e=a.value;r(e)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=c.return)&&(yield o.call(c))}finally{if(n)throw n.error}}else i.map((e=>r(e)));var u},new((i=void 0)||(i=Promise))((function(e,t){function r(e){try{c(a.next(e))}catch(e){t(e)}}function s(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(r,s)}c((a=a.apply(n,o||[])).next())}));var n,o,i,a}))}});return()=>_(i)}))};function P(e){return new w((t=>{let r=0;const n=setInterval((()=>{t.next(r++)}),e);return()=>clearInterval(n)}))}const E=function(e){return t=>new k((r=>{const o=new n(r),s=t.subscribe({complete(){o.complete()},error(e){o.error(e)},next(t){o.schedule((r=>{return n=this,o=void 0,i=function*(){const n=yield e(t);r(n)},new((s=void 0)||(s=Promise))((function(e,t){function r(e){try{c(i.next(e))}catch(e){t(e)}}function a(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof s?n:new s((function(e){e(n)}))).then(r,a)}c((i=i.apply(n,o||[])).next())}));var n,o,s,i}))}});return()=>_(s)}))},M=function(...e){return 0===e.length?w.from([]):new w((t=>{let r=0;const n=e.map((n=>n.subscribe({error(e){t.error(e),o()},next(e){t.next(e)},complete(){++r===e.length&&(t.complete(),o())}}))),o=()=>{n.forEach((e=>_(e)))};return o}))},j=class extends k{constructor(){super((e=>(this._observers.add(e),()=>this._observers.delete(e)))),this._observers=new Set}next(e){for(const t of this._observers)t.next(e)}error(e){for(const t of this._observers)t.error(e)}complete(){for(const e of this._observers)e.complete()}},S=function(e){const t=new j;let r,n=0;return new k((o=>{r||(r=e.subscribe(t));const s=t.subscribe(o);return n++,()=>{n--,s.unsubscribe(),0===n&&(_(r),r=void 0)}}))};const O=function(e,t){return r=>new k((o=>{let s,i=0;const a=new n(o),c=r.subscribe({complete(){a.complete()},error(e){a.error(e)},next(r){a.schedule((n=>{return o=this,a=void 0,u=function*(){const o=0===i?void 0===t?r:t:s;s=yield e(o,r,i++),n(s)},new((c=void 0)||(c=Promise))((function(e,t){function r(e){try{s(u.next(e))}catch(e){t(e)}}function n(e){try{s(u.throw(e))}catch(e){t(e)}}function s(t){var o;t.done?e(t.value):(o=t.value,o instanceof c?o:new c((function(e){e(o)}))).then(r,n)}s((u=u.apply(o,a||[])).next())}));var o,a,c,u}))}});return()=>_(c)}))}},467:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=t.deserialize=t.registerSerializer=void 0;const n=r(381);let o=n.DefaultSerializer;t.registerSerializer=function(e){o=n.extendSerializer(o,e)},t.deserialize=function(e){return o.deserialize(e)},t.serialize=function(e){return o.serialize(e)}},734:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.Transfer=t.DefaultSerializer=t.expose=t.registerSerializer=void 0;var s=r(467);Object.defineProperty(t,"registerSerializer",{enumerable:!0,get:function(){return s.registerSerializer}}),o(r(63),t);var i=r(934);Object.defineProperty(t,"expose",{enumerable:!0,get:function(){return i.expose}});var a=r(381);Object.defineProperty(t,"DefaultSerializer",{enumerable:!0,get:function(){return a.DefaultSerializer}});var c=r(180);Object.defineProperty(t,"Transfer",{enumerable:!0,get:function(){return c.Transfer}})},211:(e,t)=>{"use strict";let r;function n(e){return(""+e).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}Object.defineProperty(t,"__esModule",{value:!0}),t.getBundleURL=t.getBaseURL=void 0,t.getBundleURL=function(){return r||(r=function(){try{throw new Error}catch(e){const t=(""+e.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(t)return n(t[0])}return"/"}()),r},t.getBaseURL=n},390:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerRuntime=t.getWorkerImplementation=t.defaultPoolSize=void 0;const n=r(211);t.defaultPoolSize="undefined"!=typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4;const o=e=>/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(e);function s(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}let i;t.getWorkerImplementation=function(){return i||(i=function(){if("undefined"==typeof Worker)return class{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}};class e extends Worker{constructor(e,t){var r,i;"string"==typeof e&&t&&t._baseURL?e=new URL(e,t._baseURL):"string"==typeof e&&!o(e)&&n.getBundleURL().match(/^file:\/\//i)&&(e=new URL(e,n.getBundleURL().replace(/\/[^\/]+$/,"/")),true&&(e=s(`importScripts(${JSON.stringify(e)});`))),true&&(e=s(`importScripts(${JSON.stringify(e)});`)),super(e,t)}}class t extends e{constructor(e,t){super(window.URL.createObjectURL(e),t)}static fromText(e,r){const n=new window.Blob([e],{type:"text/javascript"});return new t(n,r)}}return{blob:t,default:e}}()),i},t.isWorkerRuntime=function(){const e="undefined"!=typeof self&&"undefined"!=typeof Window&&self instanceof Window;return!("undefined"==typeof self||!self.postMessage||e)}},63:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Worker=t.BlobWorker=t.isWorkerRuntime=t.Thread=t.spawn=t.Pool=void 0;const n=r(390);Object.defineProperty(t,"isWorkerRuntime",{enumerable:!0,get:function(){return n.isWorkerRuntime}});var o=r(337);Object.defineProperty(t,"Pool",{enumerable:!0,get:function(){return o.Pool}});var s=r(264);Object.defineProperty(t,"spawn",{enumerable:!0,get:function(){return s.spawn}});var i=r(235);Object.defineProperty(t,"Thread",{enumerable:!0,get:function(){return i.Thread}}),t.BlobWorker=n.getWorkerImplementation().blob,t.Worker=n.getWorkerImplementation().default},891:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createProxyModule=t.createProxyFunction=void 0;const o=n(r(227)),s=r(49),i=r(467),a=r(15),c=r(180),u=r(229),l=o.default("threads:master:messages");let f=1;function d(e,t){return(...r)=>{const n=f++,{args:o,transferables:d}=function(e){if(0===e.length)return{args:[],transferables:[]};const t=[],r=[];for(const n of e)c.isTransferDescriptor(n)?(t.push(i.serialize(n.send)),r.push(...n.transferables)):t.push(i.serialize(n));return{args:t,transferables:0===r.length?r:(n=r,Array.from(new Set(n)))};var n}(r),p={type:u.MasterMessageType.run,uid:n,method:t,args:o};l("Sending command to run function to worker:",p);try{e.postMessage(p,d)}catch(e){return a.ObservablePromise.from(Promise.reject(e))}return a.ObservablePromise.from(s.multicast(function(e,t){return new s.Observable((r=>{let n;const o=s=>{var a;if(l("Message from worker:",s.data),s.data&&s.data.uid===t)if((a=s.data)&&a.type===u.WorkerMessageType.running)n=s.data.resultType;else if((e=>e&&e.type===u.WorkerMessageType.result)(s.data))"promise"===n?(void 0!==s.data.payload&&r.next(i.deserialize(s.data.payload)),r.complete(),e.removeEventListener("message",o)):(s.data.payload&&r.next(i.deserialize(s.data.payload)),s.data.complete&&(r.complete(),e.removeEventListener("message",o)));else if((e=>e&&e.type===u.WorkerMessageType.error)(s.data)){const t=i.deserialize(s.data.error);r.error(t),e.removeEventListener("message",o)}};return e.addEventListener("message",o),()=>{if("observable"===n||!n){const r={type:u.MasterMessageType.cancel,uid:t};e.postMessage(r)}e.removeEventListener("message",o)}}))}(e,n)))}}t.createProxyFunction=d,t.createProxyModule=function(e,t){const r={};for(const n of t)r[n]=d(e,n);return r}},774:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.PoolEventType=void 0,(r=t.PoolEventType||(t.PoolEventType={})).initialized="initialized",r.taskCanceled="taskCanceled",r.taskCompleted="taskCompleted",r.taskFailed="taskFailed",r.taskQueued="taskQueued",r.taskQueueDrained="taskQueueDrained",r.taskStart="taskStart",r.terminated="terminated"},337:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function i(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Pool=t.Thread=t.PoolEventType=void 0;const s=o(r(227)),i=r(49),a=r(531),c=r(390),u=r(774);Object.defineProperty(t,"PoolEventType",{enumerable:!0,get:function(){return u.PoolEventType}});const l=r(235);Object.defineProperty(t,"Thread",{enumerable:!0,get:function(){return l.Thread}});let f=1;class d{constructor(e,t){this.eventSubject=new i.Subject,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];const r="number"==typeof t?{size:t}:t||{},{size:n=c.defaultPoolSize}=r;var o;this.debug=s.default(`threads:pool:${o=r.name||String(f++),o.replace(/\W/g," ").trim().replace(/\s+/g,"-")}`),this.options=r,this.workers=function(e,t){return function(e){const t=[];for(let r=0;r<e;r++)t.push(r);return t}(t).map((()=>({init:e(),runningTasks:[]})))}(e,n),this.eventObservable=i.multicast(i.Observable.from(this.eventSubject)),Promise.all(this.workers.map((e=>e.init))).then((()=>this.eventSubject.next({type:u.PoolEventType.initialized,size:this.workers.length})),(e=>{this.debug("Error while initializing pool worker:",e),this.eventSubject.error(e),this.initErrors.push(e)}))}findIdlingWorker(){const{concurrency:e=1}=this.options;return this.workers.find((t=>t.runningTasks.length<e))}runPoolTask(e,t){return n(this,void 0,void 0,(function*(){const r=this.workers.indexOf(e)+1;this.debug(`Running task #${t.id} on worker #${r}...`),this.eventSubject.next({type:u.PoolEventType.taskStart,taskID:t.id,workerID:r});try{const n=yield t.run(yield e.init);this.debug(`Task #${t.id} completed successfully`),this.eventSubject.next({type:u.PoolEventType.taskCompleted,returnValue:n,taskID:t.id,workerID:r})}catch(e){this.debug(`Task #${t.id} failed`),this.eventSubject.next({type:u.PoolEventType.taskFailed,taskID:t.id,error:e,workerID:r})}}))}run(e,t){return n(this,void 0,void 0,(function*(){const r=(()=>n(this,void 0,void 0,(function*(){yield(0,new Promise((e=>setTimeout(e,0))));try{yield this.runPoolTask(e,t)}finally{e.runningTasks=e.runningTasks.filter((e=>e!==r)),this.isClosing||this.scheduleWork()}})))();e.runningTasks.push(r)}))}scheduleWork(){this.debug("Attempt de-queueing a task in order to run it...");const e=this.findIdlingWorker();if(!e)return;const t=this.taskQueue.shift();if(!t)return this.debug("Task queue is empty"),void this.eventSubject.next({type:u.PoolEventType.taskQueueDrained});this.run(e,t)}taskCompletion(e){return new Promise(((t,r)=>{const n=this.events().subscribe((o=>{o.type===u.PoolEventType.taskCompleted&&o.taskID===e?(n.unsubscribe(),t(o.returnValue)):o.type===u.PoolEventType.taskFailed&&o.taskID===e?(n.unsubscribe(),r(o.error)):o.type===u.PoolEventType.terminated&&(n.unsubscribe(),r(Error("Pool has been terminated before task was run.")))}))}))}settled(e=!1){return n(this,void 0,void 0,(function*(){const t=()=>{return e=this.workers,t=e=>e.runningTasks,e.reduce(((e,r)=>[...e,...t(r)]),[]);var e,t},r=[],n=this.eventObservable.subscribe((e=>{e.type===u.PoolEventType.taskFailed&&r.push(e.error)}));return this.initErrors.length>0?Promise.reject(this.initErrors[0]):e&&0===this.taskQueue.length?(yield a.allSettled(t()),r):(yield new Promise(((e,t)=>{const r=this.eventObservable.subscribe({next(t){t.type===u.PoolEventType.taskQueueDrained&&(r.unsubscribe(),e(void 0))},error:t})})),yield a.allSettled(t()),n.unsubscribe(),r)}))}completed(e=!1){return n(this,void 0,void 0,(function*(){const t=this.settled(e),r=new Promise(((e,r)=>{const n=this.eventObservable.subscribe({next(o){o.type===u.PoolEventType.taskQueueDrained?(n.unsubscribe(),e(t)):o.type===u.PoolEventType.taskFailed&&(n.unsubscribe(),r(o.error))},error:r})})),n=yield Promise.race([t,r]);if(n.length>0)throw n[0]}))}events(){return this.eventObservable}queue(e){const{maxQueuedJobs:t=1/0}=this.options;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];const r=this.nextTaskID++,n=this.taskCompletion(r);n.catch((e=>{this.debug(`Task #${r} errored:`,e)}));const o={id:r,run:e,cancel:()=>{-1!==this.taskQueue.indexOf(o)&&(this.taskQueue=this.taskQueue.filter((e=>e!==o)),this.eventSubject.next({type:u.PoolEventType.taskCanceled,taskID:o.id}))},then:n.then.bind(n)};if(this.taskQueue.length>=t)throw Error("Maximum number of pool tasks queued. Refusing to queue another one.\nThis usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.");return this.debug(`Queueing task #${o.id}...`),this.taskQueue.push(o),this.eventSubject.next({type:u.PoolEventType.taskQueued,taskID:o.id}),this.scheduleWork(),o}terminate(e){return n(this,void 0,void 0,(function*(){this.isClosing=!0,e||(yield this.completed(!0)),this.eventSubject.next({type:u.PoolEventType.terminated,remainingQueue:[...this.taskQueue]}),this.eventSubject.complete(),yield Promise.all(this.workers.map((e=>n(this,void 0,void 0,(function*(){return l.Thread.terminate(yield e.init)})))))}))}}function p(e,t){return new d(e,t)}d.EventType=u.PoolEventType,p.EventType=u.PoolEventType,t.Pool=p},264:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function i(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.spawn=void 0;const s=o(r(227)),i=r(49),a=r(467),c=r(104),u=r(258),l=r(356),f=r(891),d=s.default("threads:master:messages"),p=s.default("threads:master:spawn"),h=s.default("threads:master:thread-utils"),y="undefined"!=typeof process&&process.env.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt(process.env.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function b(e,t,r,n){const o=r.filter((e=>e.type===l.WorkerEventType.internalError)).map((e=>e.error));return Object.assign(e,{[u.$errors]:o,[u.$events]:r,[u.$terminate]:n,[u.$worker]:t})}t.spawn=function(e,t){return n(this,void 0,void 0,(function*(){p("Initializing new thread");const r=t&&t.timeout?t.timeout:y,o=yield function(e,t,r){return n(this,void 0,void 0,(function*(){let n;const o=new Promise(((e,o)=>{n=setTimeout((()=>o(Error(r))),t)})),s=yield Promise.race([e,o]);return clearTimeout(n),s}))}(function(e){return new Promise(((t,r)=>{const n=o=>{var s;d("Message from worker before finishing initialization:",o.data),(s=o.data)&&"init"===s.type?(e.removeEventListener("message",n),t(o.data)):(e=>e&&"uncaughtError"===e.type)(o.data)&&(e.removeEventListener("message",n),r(a.deserialize(o.data.error)))};e.addEventListener("message",n)}))}(e),r,`Timeout: Did not receive an init message from worker after ${r}ms. Make sure the worker calls expose().`),s=o.exposed,{termination:u,terminate:m}=function(e){const[t,r]=c.createPromiseWithResolver();return{terminate:()=>n(this,void 0,void 0,(function*(){h("Terminating worker"),yield e.terminate(),r()})),termination:t}}(e),v=function(e,t){return new i.Observable((r=>{const n=e=>{const t={type:l.WorkerEventType.message,data:e.data};r.next(t)},o=e=>{h("Unhandled promise rejection event in thread:",e);const t={type:l.WorkerEventType.internalError,error:Error(e.reason)};r.next(t)};e.addEventListener("message",n),e.addEventListener("unhandledrejection",o),t.then((()=>{const t={type:l.WorkerEventType.termination};e.removeEventListener("message",n),e.removeEventListener("unhandledrejection",o),r.next(t),r.complete()}))}))}(e,u);if("function"===s.type)return b(f.createProxyFunction(e),e,v,m);if("module"===s.type)return b(f.createProxyModule(e,s.methods),e,v,m);{const e=s.type;throw Error(`Worker init message states unexpected type of expose(): ${e}`)}}))}},235:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Thread=void 0;const n=r(258);function o(e){throw Error(e)}t.Thread={errors:e=>e[n.$errors]||o("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),events:e=>e[n.$events]||o("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),terminate:e=>e[n.$terminate]()}},15:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObservablePromise=void 0;const n=r(49),o=()=>{},s=e=>e,i=e=>Promise.resolve().then(e);function a(e){throw e}class c extends n.Observable{constructor(e){super((t=>{const r=this,n=Object.assign(Object.assign({},t),{complete(){t.complete(),r.onCompletion()},error(e){t.error(e),r.onError(e)},next(e){t.next(e),r.onNext(e)}});try{return this.initHasRun=!0,e(n)}catch(e){n.error(e)}})),this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(e){this.firstValueSet||(this.firstValue=e,this.firstValueSet=!0)}onError(e){this.state="rejected",this.rejection=e;for(const t of this.rejectionCallbacks)i((()=>t(e)))}onCompletion(){this.state="fulfilled";for(const e of this.fulfillmentCallbacks)i((()=>e(this.firstValue)))}then(e,t){const r=e||s,n=t||a;let o=!1;return new Promise(((e,t)=>{const s=r=>{if(!o){o=!0;try{e(n(r))}catch(e){t(e)}}};return this.initHasRun||this.subscribe({error:s}),"fulfilled"===this.state?e(r(this.firstValue)):"rejected"===this.state?(o=!0,e(n(this.rejection))):(this.fulfillmentCallbacks.push((t=>{try{e(r(t))}catch(e){s(e)}})),void this.rejectionCallbacks.push(s))}))}catch(e){return this.then(void 0,e)}finally(e){const t=e||o;return this.then((e=>(t(),e)),(()=>t()))}static from(e){return function(e){return e&&"function"==typeof e.then}(e)?new c((t=>{e.then((e=>{t.next(e),t.complete()}),(e=>{t.error(e)}))})):super.from(e)}}t.ObservablePromise=c},531:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.allSettled=void 0,t.allSettled=function(e){return Promise.all(e.map((e=>{const t=e=>({status:"fulfilled",value:e}),r=e=>({status:"rejected",reason:e}),n=Promise.resolve(e);try{return n.then(t,r)}catch(e){return Promise.reject(e)}})))}},104:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPromiseWithResolver=void 0;const r=()=>{};t.createPromiseWithResolver=function(){let e,t=!1,n=r;return[new Promise((r=>{t?r(e):n=r})),r=>{t=!0,e=r,n(e)}]}},381:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultSerializer=t.extendSerializer=void 0,t.extendSerializer=function(e,t){const r=e.deserialize.bind(e),n=e.serialize.bind(e);return{deserialize:e=>t.deserialize(e,r),serialize:e=>t.serialize(e,n)}};const r=e=>Object.assign(Error(e.message),{name:e.name,stack:e.stack}),n=e=>({__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack});t.DefaultSerializer={deserialize(e){return(t=e)&&"object"==typeof t&&"__error_marker"in t&&"$$error"===t.__error_marker?r(e):e;var t},serialize:e=>e instanceof Error?n(e):e}},258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.$worker=t.$transferable=t.$terminate=t.$events=t.$errors=void 0,t.$errors=Symbol("thread.errors"),t.$events=Symbol("thread.events"),t.$terminate=Symbol("thread.terminate"),t.$transferable=Symbol("thread.transferable"),t.$worker=Symbol("thread.worker")},180:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Transfer=t.isTransferDescriptor=void 0;const n=r(258);t.isTransferDescriptor=function(e){return e&&"object"==typeof e&&e[n.$transferable]},t.Transfer=function(e,t){if(!t){if(!(r=e)||"object"!=typeof r)throw Error();t=[e]}var r;return{[n.$transferable]:!0,send:e,transferables:t}}},356:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerEventType=void 0,r(258),(n=t.WorkerEventType||(t.WorkerEventType={})).internalError="internalError",n.message="message",n.termination="termination"},229:(e,t)=>{"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerMessageType=t.MasterMessageType=void 0,(n=t.MasterMessageType||(t.MasterMessageType={})).cancel="cancel",n.run="run",(r=t.WorkerMessageType||(t.WorkerMessageType={})).error="error",r.init="init",r.result="result",r.running="running",r.uncaughtError="uncaughtError"},447:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={isWorkerRuntime:function(){const e="undefined"!=typeof self&&"undefined"!=typeof Window&&self instanceof Window;return!("undefined"==typeof self||!self.postMessage||e)},postMessageToMaster:function(e,t){self.postMessage(e,t)},subscribeToMasterMessages:function(e){const t=t=>{e(t.data)};return self.addEventListener("message",t),()=>{self.removeEventListener("message",t)}}}},934:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function i(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.expose=t.isWorkerRuntime=t.Transfer=t.registerSerializer=void 0;const s=o(r(898)),i=r(467),a=r(180),c=r(229),u=o(r(447));var l=r(467);Object.defineProperty(t,"registerSerializer",{enumerable:!0,get:function(){return l.registerSerializer}});var f=r(180);Object.defineProperty(t,"Transfer",{enumerable:!0,get:function(){return f.Transfer}}),t.isWorkerRuntime=u.default.isWorkerRuntime;let d=!1;const p=new Map,h=e=>e&&e.type===c.MasterMessageType.run,y=e=>s.default(e)||function(e){return e&&"object"==typeof e&&"function"==typeof e.subscribe}(e);function b(e){return a.isTransferDescriptor(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function m(e,t){const{payload:r,transferables:n}=b(t),o={type:c.WorkerMessageType.error,uid:e,error:i.serialize(r)};u.default.postMessageToMaster(o,n)}function v(e,t,r){const{payload:n,transferables:o}=b(r),s={type:c.WorkerMessageType.result,uid:e,complete:!!t||void 0,payload:n};u.default.postMessageToMaster(s,o)}function g(e){try{const t={type:c.WorkerMessageType.uncaughtError,error:i.serialize(e)};u.default.postMessageToMaster(t)}catch(t){console.error("Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\nLatest error:",t,"\nOriginal error:",e)}}function w(e,t,r){return n(this,void 0,void 0,(function*(){let n;try{n=t(...r)}catch(t){return m(e,t)}const o=y(n)?"observable":"promise";if(function(e,t){const r={type:c.WorkerMessageType.running,uid:e,resultType:t};u.default.postMessageToMaster(r)}(e,o),y(n)){const t=n.subscribe((t=>v(e,!1,i.serialize(t))),(t=>{m(e,i.serialize(t)),p.delete(e)}),(()=>{v(e,!0),p.delete(e)}));p.set(e,t)}else try{const t=yield n;v(e,!0,i.serialize(t))}catch(t){m(e,i.serialize(t))}}))}t.expose=function(e){if(!u.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(d)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(d=!0,"function"==typeof e)u.default.subscribeToMasterMessages((t=>{h(t)&&!t.method&&w(t.uid,e,t.args.map(i.deserialize))})),function(){const e={type:c.WorkerMessageType.init,exposed:{type:"function"}};u.default.postMessageToMaster(e)}();else{if("object"!=typeof e||!e)throw Error(`Invalid argument passed to expose(). Expected a function or an object, got: ${e}`);u.default.subscribeToMasterMessages((t=>{h(t)&&t.method&&w(t.uid,e[t.method],t.args.map(i.deserialize))})),function(e){const t={type:c.WorkerMessageType.init,exposed:{type:"module",methods:e}};u.default.postMessageToMaster(t)}(Object.keys(e).filter((t=>"function"==typeof e[t])))}u.default.subscribeToMasterMessages((e=>{if((t=e)&&t.type===c.MasterMessageType.cancel){const t=e.uid,r=p.get(t);r&&(r.unsubscribe(),p.delete(t))}var t}))},"undefined"!=typeof self&&"function"==typeof self.addEventListener&&u.default.isWorkerRuntime()&&(self.addEventListener("error",(e=>{setTimeout((()=>g(e.error||e)),250)})),self.addEventListener("unhandledrejection",(e=>{const t=e.reason;t&&"string"==typeof t.message&&setTimeout((()=>g(t)),250)}))),"undefined"!=typeof process&&"function"==typeof process.on&&u.default.isWorkerRuntime()&&(process.on("uncaughtException",(e=>{setTimeout((()=>g(e)),250)})),process.on("unhandledRejection",(e=>{e&&"string"==typeof e.message&&setTimeout((()=>g(e)),250)})))}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{"use strict";r.r(n),r.d(n,{default:()=>c});var e=r(734);e.registerSerializer;const t=e.spawn,o=(e.BlobWorker,e.DefaultSerializer,e.Pool),s=(e.Thread,e.Transfer,e.Worker);let i;class a{constructor(e){this.workerLib=e}async decodeWav(e){return this.workerLib.decodeWav(e)}async generateVxlGeometry(e,t){return this.workerLib.generateVxlGeometry(e.toPlain(),t)}async compressFile(e,t){return this.workerLib.compressFile(e,t)}}const c={concurrency:(navigator.hardwareConcurrency||4)-1,warmUpPool(){return i??(i=o((()=>t(new s("./dist/worker.min.js?v=0.57.2"))),this.concurrency))},queueTask(e){this.warmUpPool(),i.queue((t=>e(new a(t))))},async waitForTasks(){await(i?.completed())},async dispose(){i&&(await i.terminate(),i=void 0)}}})(),CDWorkerHostLib=n.default})();